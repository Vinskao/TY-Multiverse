---
import BaseLayout from "../layouts/BaseLayout.astro";
import Hero from "../components/Hero.astro";
import { initializeApp } from 'firebase/app';
import { getDatabase, ref, set } from 'firebase/database';
import { getStorage, ref as storageRef, uploadString, getDownloadURL } from 'firebase/storage';
import dotenv from 'dotenv';
import axios from 'axios';
import * as fs from 'fs';


---

<!DOCTYPE html>
<meta charset="UTF-8" />
<html>
  <head>
    <style>
      .powers-container {
        display: flex;
        justify-content: space-between;
      }
      #totalPhysicPowerHagishi,
      #totalMagicPowerHagishi,
      #totalUtilityPowerHagishi,
      #totalPhysicPowerHagisun,
      #totalMagicPowerHagisun,
      #totalUtilityPowerHagisun,
      #totalPhysicPowerForthgate,
      #totalMagicPowerForthgate,
      #totalUtilityPowerForthgate,
      #totalPhysicPowerMutav,
      #totalMagicPowerMutav,
      #totalUtilityPowerMutav,
      #totalHagishi,
      #totalHagisun,
      #totalForthgate,
      #totalMutav {
        flex: 1;
        font-size: 12px; 
      }


      h6 {
        padding-left: 50px;
      }
      main.wrapper {
        margin: 5%;
        padding: 0;
        max-width: 100%;
      }
      main.wrapper .stack {
        gap: 10px;
      }
      .overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 999;
      }
      #cardImagesForthgate,#cardImagesHagisun,#cardImagesHagishi,#cardImagesMutav {
        white-space: nowrap;
        overflow-x: auto;
      }
      #cardImagesAll {
        white-space: nowrap;
        overflow-x: auto;
      }
      #cardImagesHagishi #cardImagesHagisun #cardImagesMutav {
        white-space: nowrap;
        overflow-x: auto;
      }
    </style>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.2/firebase-storage.js"></script>
  </head>
  <body>
    <BaseLayout
      title="Palais | Wavo Yuropha"
      description="Learn about TY's most recent projects"
    >
      <div class="stack gap-20">
        <main class="wrapper stack gap-8">
          <Hero
            title="Palais"
            tagline="Welcome to Lily Palais."
            align="start"
          />
          <h1>八食</h1>
          <h1>初桑</h1>
          <h1>肆門</h1>
          <h1>Phénix</h1>
          <h1>Buse</h1>
          <h1>家累</h1>
          <h1>塵民</h1>
          <h1>古女</h1>
          <h1>獄女</h1>
          <div id="buttoms">
            <button id="shuffleButton" onclick="shuffle()">洗牌</button>
            <button id="getHagishiButton" onclick="getHagishi()"
              >八食戰隊</button
            >
            <button id="getHagisunButton" onclick="getHagisun()"
              >初桑戰隊</button
            >
            <button id="getForthgateButton" onclick="getForthgate()"
              >肆門戰隊</button
            >
            <button id="getMutavButton" onclick="getMutav()">Phénix戰隊</button>
            <button id="getAllButton" onclick="getAll()">隨機戰隊</button>
          </div>
          <h6>八食戰隊:</h6>
          <div id="system">
            <div id="cardImagesHagishi"></div>
          </div>
          <div class="powers-container">
            <div id="totalPhysicPowerHagishi">Hagishi物理能力：0</div>
            <div id="totalMagicPowerHagishi">Hagishi魔法能力：0</div>
            <div id="totalUtilityPowerHagishi">Hagishi戰術能力：0</div>
            <div id="totalHagishi">Hagishi總能力：0</div>

          </div>
          <h6>初桑戰隊:</h6>
          <div id="system">
            <div id="cardImagesHagisun"></div>
          </div>
          <div class="powers-container">
            <div id="totalPhysicPowerHagisun">Hagisun物理能力：0</div>
            <div id="totalMagicPowerHagisun">Hagisun魔法能力：0</div>
            <div id="totalUtilityPowerHagisun">Hagisun戰術能力：0</div>
            <div id="totalHagisun">Hagisun總能力：0</div>

          </div>

          <h6>肆門戰隊:</h6>
          <div id="system">
            <div id="cardImagesForthgate"></div>
          </div>
          <div class="powers-container">
            <div id="totalPhysicPowerForthgate">Forthgate物理能力：0</div>
            <div id="totalMagicPowerForthgate">Forthgate魔法能力：0</div>
            <div id="totalUtilityPowerForthgate">Forthgate戰術能力：0</div>
            <div id="totalForthgate">Forthgate總能力：0</div>

          </div>

          <h6>Phénix戰隊:</h6>
          <div id="system">
            <div id="cardImagesMutav"></div>
          </div>
          <div class="powers-container">
            <div id="totalPhysicPowerMutav">Mutav物理能力：0</div>
            <div id="totalMagicPowerMutav">Mutav魔法能力：0</div>
            <div id="totalUtilityPowerMutav">Mutav戰術能力：0</div>
            <div id="totalMutav">Mutav總能力：0</div>

          </div>

          <h6>隨機戰隊:</h6>
          <div id="system">
            <div id="cardImagesAll"></div>
          </div>
          <!-- <div class="image-container">
            <img alt="Wavo" src="/assets/Wavo.png" />
            <img alt="Chiaki" src="/assets/Chiaki.png" />
            <img alt="Sayuri" src="/assets/Sayuri.png" />
            <img alt="Hitomi" src="/assets/Hitomi.png" />
            <img alt="Akimoto_Yuko" src="/assets/Akimoto_Yuko.png" />
            <img alt="Etsuko" src="/assets/Etsuko.png" />
            <img alt="Masako" src="/assets/Masako.png" />
          </div>

          <div class="image-container">
            <img alt="Médicis_Monroe" src="/assets/Médicis_Monroe.png" />
          </div>

          <div class="image-container">
            <img alt="Sorane" src="/assets/Sorane.png" />
            <img alt="Kyu" src="/assets/Kyu.png" />
            <img alt="Riuri" src="/assets/Riuri.png" />
            <img alt="Natsumi" src="/assets/Natsumi.png" />
            <img alt="Kamira" src="/assets/Kamira.png" />
            <img alt="Kazuko" src="/assets/Kazuko.png" />
            <img alt="Miyu" src="/assets/Miyu.png" />
            <img alt="Valmet" src="/assets/Valmet.png" />
            <img alt="Mayo" src="/assets/Mayo.png" />
          </div>

          <div class="image-container">
            <img alt="samui" src="/assets/Samui.png" />
            <img alt="Paprika" src="/assets/Paprika.png" />
            <img alt="Caleigh" src="/assets/Caleigh.png" />
            <img alt="Doire_Evewch" src="/assets/Doire_Evewch.png" />
            <img alt="Z" src="/assets/Z.png" />
            <img alt="Branwen" src="/assets/Branwen.png" />
            <img alt="Lucrece_Yurophas" src="/assets/Lucrece_Yurophas.png" />
            <img alt="Uiobbeci" src="/assets/Uiobbeci.png" />
            <img alt="Draeny_Chevrem" src="/assets/Draeny_Chevrem.png" />
            <img alt="Nianca_K794" src="/assets/Nianca_K794.png" />
            <img alt="Yui" src="/assets/Yui.png" />
            <img alt="Yui" src="/assets/Mesoyei.png" />
          </div> -->
        </main>
      </div>
    </BaseLayout>

    <!-- 全屏遮罩 -->

    <div class="overlay" id="passwordOverlay">
      <script>
        var isAuthenticated = false;

        if (!isAuthenticated) {
          var password = prompt("請輸入密碼", "");
          if (password === "1") {
            isAuthenticated = true;
            document.getElementById("passwordOverlay").style.display = "none";
          } else {
            alert("請再輸入一次密碼");
            location.href = "examples/javascript/16ex2.html";
          }
        }
      </script>
    </div>

    <script>
      // const firebaseConfig = {
      //   apiKey: process.env.FIREBASE_API_KEY,
      //   authDomain: process.env.FIREBASE_AUTH_DOMAIN,
      //   databaseURL: process.env.FIREBASE_DATABASE_URL,
      //   projectId: process.env.FIREBASE_PROJECT_ID,
      //   storageBucket: process.env.FIREBASE_STORAGE_BUCKET,
      //   messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,
      //   appId: process.env.FIREBASE_APP_ID,
      //   measurementId: process.env.FIREBASE_MEASUREMENT_ID
      // };

      document.addEventListener("DOMContentLoaded", function () {
        const cards = [
          { name: "Wavo", physicPower: 55, magicPower: 2999, utilityPower: 46 },
          { name: "Chiaki", physicPower: 876, magicPower: 513, utilityPower: 764 },
          { name: "Sayuri", physicPower: 916, magicPower: 456, utilityPower: 695 },
          { name: "Hitomi", physicPower: 892, magicPower: 349, utilityPower: 632 },
          { name: "Akimoto_Yuko", physicPower: 246, magicPower: 0, utilityPower: 1201 },
          { name: "Etsuko", physicPower: 769, magicPower: 0, utilityPower: 1164 },
          { name: "Masako", physicPower: 1453, magicPower: 131, utilityPower: 0 },
          { name: "Sorane", physicPower: 859, magicPower: 461, utilityPower: 603 },
          { name: "Kyu", physicPower: 311, magicPower: 843, utilityPower: 0 },
          { name: "Riuri", physicPower: 689, magicPower: 0, utilityPower: 431 },
          { name: "Natsumi", physicPower: 653, magicPower: 0, utilityPower: 649 },
          { name: "Kamira", physicPower: 390, magicPower: 886, utilityPower: 60 },
          { name: "Kazuko", physicPower: 714, magicPower: 564, utilityPower: 243 },
          { name: "Miyu", physicPower: 346, magicPower: 864, utilityPower: 0 },
          { name: "Valmet", physicPower: 594, magicPower: 0, utilityPower: 623 },
          { name: "Mayo", physicPower: 564, magicPower: 411, utilityPower: 925 },
          { name: "Samui", physicPower: 395, magicPower: 516, utilityPower: 511 },
          { name: "Paprika", physicPower: 154, magicPower: 431, utilityPower: 131 },
          { name: "Caleigh", physicPower: 601, magicPower: 26, utilityPower: 201 },
          { name: "Doire_Evewch", physicPower: 567, magicPower: 32, utilityPower: 165 },
          { name: "Z", physicPower: 423, magicPower: 0, utilityPower: 246 },
          { name: "Branwen", physicPower: 372, magicPower: 419, utilityPower: 294 },
          { name: "Lucrece_Yurophas", physicPower: 531, magicPower: 13, utilityPower: 264 },
          { name: "Uiobbeci", physicPower: 32, magicPower: 503, utilityPower: 61 },
          { name: "Draeny_Chevrem", physicPower: 583, magicPower: 94, utilityPower: 394 },
          { name: "Nianca_K794", physicPower: 53, magicPower: 0, utilityPower: 241 },
          { name: "Yui", physicPower: 16, magicPower: 0, utilityPower: 164 },
          { name: "Mesoyei", physicPower: 565, magicPower: 43, utilityPower: 349 },
          { name: "Médicis_Monroe", physicPower: 1264, magicPower: 261, utilityPower: 110 },
        ];

        // const cards = [];
        // // 读取palais.json文件
        // fs.readFile('palais.json', 'utf8', (err, data) => {
        //   if (err) {
        //     console.error('读取文件时出错：', err);
        //     return;
        //   }

        //   try {
        //     // 将JSON数据解析为JavaScript对象
        //     const palaisData = JSON.parse(data);

        //     // 循环遍历palaisData数组，提取所需的数据并添加到cards数组
        //     for (const item of palaisData) {
        //       const card = {
        //         name: item.name,
        //         physicPower: item.physicPower,
        //         magicPower: item.magicPower,
        //         utilityPower: item.utilityPower,
        //       };
        //       cards.push(card);
        //     }

        //     // 打印提取的数据
        //     console.log(cards);
        //   } catch (error) {
        //     console.error('解析JSON时出错：', error);
        //   }
        // });

        var imageNamesAll = [
          "Wavo.png",
          "Chiaki.png",
          "Sayuri.png",
          "Hitomi.png",
          "Akimoto_Yuko.png",
          "Etsuko.png",
          "Masako.png",
          "Sorane.png",
          "Kyu.png",
          "Riuri.png",
          "Natsumi.png",
          "Kamira.png",
          "Kazuko.png",
          "Miyu.png",
          "Valmet.png",
          "Mayo.png",
          "Samui.png",
          "Paprika.png",
          "Caleigh.png",
          "Doire_Evewch.png",
          "Z.png",
          "Branwen.png",
          "Lucrece_Yurophas.png",
          "Uiobbeci.png",
          "Draeny_Chevrem.png",
          "Nianca_K794.png",
          "Yui.png",
          "Mesoyei.png",
          "Médicis_Monroe.png",
        ];
        var imageNamesHagishi = [
          "Wavo.png",
          "Chiaki.png",
          "Sayuri.png",
          "Hitomi.png",
          "Akimoto_Yuko.png",
          "Etsuko.png",
          "Masako.png",
        ];
        var imageNamesHagisun = [
          "Sorane.png",
          "Kyu.png",
          "Riuri.png",
          "Natsumi.png",
          "Kamira.png",
          "Kazuko.png",
          "Miyu.png",
          "Valmet.png",
          "Mayo.png",
        ];
        var imageNamesForthgate = [
          "Samui.png",
          "Paprika.png",
          "Caleigh.png",
          "Doire_Evewch.png",
          "Z.png",
          "Branwen.png",
          "Lucrece_Yurophas.png",
          "Uiobbeci.png",
          "Draeny_Chevrem.png",
          "Nianca_K794.png",
          "Yui.png",
          "Mesoyei.png",
        ];
        var imageNamesMutav = ["Médicis_Monroe.png"];

        var containerIdAll = "cardImagesAll";
        var containerIdHagisun = "cardImagesHagisun";
        var containerIdForthgate = "cardImagesForthgate";
        var containerIdMutav = "cardImagesMutav";
        var containerIdHagishi = "cardImagesHagishi";

        function getForthgate() {
          var cardImagesContainer = document.getElementById(containerIdForthgate);
          cardImagesContainer.innerHTML = "";
          var totalPhysicPower = 0;
          var totalMagicPower = 0;
          var totalUtilityPower = 0;

          var availableImages = imageNamesForthgate.slice();
          for (var i = 0; i < 6; i++) {
            var randomIndex = Math.floor(Math.random() * availableImages.length);
            var selectedImageName = availableImages[randomIndex];
            availableImages.splice(randomIndex, 1);

            // 根据选中的图片名称找到对应的卡片信息
            var selectedCard = cards.find(
              (card) => card.name === selectedImageName.split(".")[0]
            );

            if (selectedCard) {
              // 更新总的物理和魔法能力值
              totalPhysicPower += selectedCard.physicPower;
              totalMagicPower += selectedCard.magicPower;
              totalUtilityPower += selectedCard.utilityPower;

              var imageUrl = `/assets/${selectedImageName}`;
              var imageContainer = document.getElementById(containerIdForthgate);
              var image = document.createElement("img");
              image.src = imageUrl;
              image.alt = "Card";
              image.style.width = "200px";
              image.style.height = "auto";
              image.style.marginRight = "-95px";
              imageContainer.appendChild(image);
            }
          }

          var totalPhysicPowerElement = document.getElementById("totalPhysicPowerForthgate");
          var totalMagicPowerElement = document.getElementById("totalMagicPowerForthgate");
          var totalUtilityPowerElement = document.getElementById("totalUtilityPowerForthgate");
          var totalForthgateElement = document.getElementById("totalForthgate"); // 新增的元素

          // 更新 Forthgate 的物理和魔法能力值
          totalPhysicPowerElement.textContent = "Forthgate物理能力：" + totalPhysicPower;
          totalMagicPowerElement.textContent = "Forthgate魔法能力：" + totalMagicPower;
          totalUtilityPowerElement.textContent = "Forthgate戰術能力：" + totalUtilityPower;

          // 计算并更新总能力值
          var totalPower = totalPhysicPower + totalMagicPower + totalUtilityPower;
          totalForthgateElement.textContent = "Forthgate總能力：" + totalPower;
        }

        var getForthgateButton = document.getElementById("getForthgateButton");
        getForthgateButton.addEventListener("click", function () {
          getForthgate();
        });

        function getMutav() {
          var cardImagesContainer = document.getElementById(containerIdMutav);
          cardImagesContainer.innerHTML = "";
          var totalPhysicPower = 0;
          var totalMagicPower = 0;
          var totalUtilityPower = 0;

          var availableImages = imageNamesMutav.slice();
          for (var i = 0; i < 1; i++) {
            var randomIndex = Math.floor(Math.random() * availableImages.length);
            var selectedImageName = availableImages[randomIndex];
            availableImages.splice(randomIndex, 1);

            // 根据选中的图片名称找到对应的卡片信息
            var selectedCard = cards.find(
              (card) => card.name === selectedImageName.split(".")[0]
            );

            if (selectedCard) {
              // 更新总的物理和魔法能力值
              totalPhysicPower += selectedCard.physicPower;
              totalMagicPower += selectedCard.magicPower;
              totalUtilityPower += selectedCard.utilityPower;

              var imageUrl = `/assets/${selectedImageName}`;
              var imageContainer = document.getElementById(containerIdMutav);
              var image = document.createElement("img");
              image.src = imageUrl;
              image.alt = "Card";
              image.style.width = "200px";
              image.style.height = "auto";
              image.style.marginRight = "-95px";
              imageContainer.appendChild(image);
            }
          }

          var totalPhysicPowerElement = document.getElementById("totalPhysicPowerMutav");
          var totalMagicPowerElement = document.getElementById("totalMagicPowerMutav");
          var totalUtilityPowerElement = document.getElementById("totalUtilityPowerMutav");
          var totalMutavElement = document.getElementById("totalMutav"); // 新增的元素

          // 更新 Mutav 的物理和魔法能力值
          totalPhysicPowerElement.textContent = "Mutav物理能力：" + totalPhysicPower;
          totalMagicPowerElement.textContent = "Mutav魔法能力：" + totalMagicPower;
          totalUtilityPowerElement.textContent = "Mutav戰術能力：" + totalUtilityPower;

          // 计算并更新总能力值
          var totalPower = totalPhysicPower + totalMagicPower + totalUtilityPower;
          totalMutavElement.textContent = "Mutav總能力：" + totalPower;
        }

        var getMutavButton = document.getElementById("getMutavButton");
        getMutavButton.addEventListener("click", function () {
          getMutav();
        });

        

        function getHagisun() {
          var cardImagesContainer = document.getElementById(containerIdHagisun);
          cardImagesContainer.innerHTML = "";
          var totalPhysicPower = 0;
          var totalMagicPower = 0;
          var totalUtilityPower = 0;

          var availableImages = imageNamesHagisun.slice();
          for (var i = 0; i < 5; i++) {
            var randomIndex = Math.floor(Math.random() * availableImages.length);
            var selectedImageName = availableImages[randomIndex];
            availableImages.splice(randomIndex, 1);

            // 根据选中的图片名称找到对应的卡片信息
            var selectedCard = cards.find(
              (card) => card.name === selectedImageName.split(".")[0]
            );

            if (selectedCard) {
              // 更新总的物理和魔法能力值
              totalPhysicPower += selectedCard.physicPower;
              totalMagicPower += selectedCard.magicPower;
              totalUtilityPower += selectedCard.utilityPower;

              var imageUrl = `/assets/${selectedImageName}`;
              var imageContainer = document.getElementById(containerIdHagisun);
              var image = document.createElement("img");
              image.src = imageUrl;
              image.alt = "Card";
              image.style.width = "200px";
              image.style.height = "auto";
              image.style.marginRight = "-95px";
              imageContainer.appendChild(image);
            }
          }

          var totalPhysicPowerElement = document.getElementById("totalPhysicPowerHagisun");
          var totalMagicPowerElement = document.getElementById("totalMagicPowerHagisun");
          var totalUtilityPowerElement = document.getElementById("totalUtilityPowerHagisun");
          var totalHagisunElement = document.getElementById("totalHagisun"); // 新增的元素

          // 更新 Hagisun 的物理和魔法能力值
          totalPhysicPowerElement.textContent = "Hagisun物理能力：" + totalPhysicPower;
          totalMagicPowerElement.textContent = "Hagisun魔法能力：" + totalMagicPower;
          totalUtilityPowerElement.textContent = "Hagisun戰術能力：" + totalUtilityPower;

          // 计算并更新总能力值
          var totalPower = totalPhysicPower + totalMagicPower + totalUtilityPower;
          totalHagisunElement.textContent = "Hagisun總能力：" + totalPower;
        }


        var getHagisunButton = document.getElementById("getHagisunButton");
        getHagisunButton.addEventListener("click", function () {
          getHagisun();
        });

        function getHagishi() {
          var cardImagesContainer = document.getElementById(containerIdHagishi);
          cardImagesContainer.innerHTML = "";
          var totalPhysicPower = 0;
          var totalMagicPower = 0;
          var totalUtilityPower = 0;

          var availableImages = imageNamesHagishi.slice();
          for (var i = 0; i < 4; i++) {
            var randomIndex = Math.floor(Math.random() * availableImages.length);
            var selectedImageName = availableImages[randomIndex];
            availableImages.splice(randomIndex, 1);

            // 根据选中的图片名称找到对应的卡片信息
            var selectedCard = cards.find(
              (card) => card.name === selectedImageName.split(".")[0]
            );

            if (selectedCard) {
              // 更新总的物理和魔法能力值
              totalPhysicPower += selectedCard.physicPower;
              totalMagicPower += selectedCard.magicPower;
              totalUtilityPower += selectedCard.utilityPower;

              var imageUrl = `/assets/${selectedImageName}`;
              var imageContainer = document.getElementById(containerIdHagishi);
              var image = document.createElement("img");
              image.src = imageUrl;
              image.alt = "Card";
              image.style.width = "200px";
              image.style.height = "auto";
              image.style.marginRight = "-95px";
              imageContainer.appendChild(image);
            }
          }

          var totalPhysicPowerElement = document.getElementById("totalPhysicPowerHagishi");
          var totalMagicPowerElement = document.getElementById("totalMagicPowerHagishi");
          var totalUtilityPowerElement = document.getElementById("totalUtilityPowerHagishi");
          var totalHagishiElement = document.getElementById("totalHagishi"); // 新增的元素

          // 更新 Hagishi 的物理和魔法能力值
          totalPhysicPowerElement.textContent = "Hagishi物理能力：" + totalPhysicPower;
          totalMagicPowerElement.textContent = "Hagishi魔法能力：" + totalMagicPower;
          totalUtilityPowerElement.textContent = "Hagishi戰術能力：" + totalUtilityPower;

          // 计算并更新总能力值
          var totalPower = totalPhysicPower + totalMagicPower + totalUtilityPower;
          totalHagishiElement.textContent = "Hagishi總能力：" + totalPower;
        }


        var getHagishiButton = document.getElementById("getHagishiButton");
        getHagishiButton.addEventListener("click", function () {
          getHagishi();
        });


        function getAll() {
          var cardImagesContainer = document.getElementById(containerIdAll);
          cardImagesContainer.innerHTML = "";
          var availableImages = imageNamesAll.slice();
          for (var i = 0; i < 7; i++) {
            var randomIndex = Math.floor(
              Math.random() * availableImages.length
            );
            var selectedImageName = availableImages[randomIndex];
            availableImages.splice(randomIndex, 1);

            var imageUrl = `/assets/${selectedImageName}`;
            var imageContainer = document.getElementById(containerIdAll);
            var image = document.createElement("img");
            image.src = imageUrl;
            image.alt = "Card";
            image.style.width = "200px";
            image.style.height = "auto";
            image.style.marginRight = "-95px";
            imageContainer.appendChild(image);
          }
        }
        var getAllButton = document.getElementById("getAllButton");
        getAllButton.addEventListener("click", function () {
          getAll();
        });


        
      });
    </script>
  </body>
</html>
